apiVersion: skaffold/v2beta27
kind: Config
metadata:
  name: k8s-demo-app
build:
  artifacts:
    - image: andregs/k8s-demo-app
      buildpacks:
        #builder: paketobuildpacks/builder:base
        builder: paketobuildpacks/builder:tiny

        # strange that skaffold detects a different set of buildpacks than ./gradlew bootBuildImage
        # I can docker run the image generated by ./gradlew bootBuildImage
        # but I cannot docker run the image generated by skaffold.

        # I tried to provide a manual selection of buildpacks do skaffold, but then I get a different error
        #buildpacks:
        #  - paketo-buildpacks/ca-certificates@3.0.3
        #  - paketo-buildpacks/bellsoft-liberica@9.1.0
        #  - paketo-buildpacks/syft@1.7.0
        #  - paketo-buildpacks/executable-jar@6.0.4
        #  - paketo-buildpacks/dist-zip@5.1.0
        #  - paketo-buildpacks/spring-boot@5.5.0

        dependencies:
          paths:
            - src
            - build.gradle.kts
            - settings.gradle.kts

deploy:
  kubectl:
    manifests:
    - k8s/*.yaml
